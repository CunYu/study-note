### HTTP简介

HTTP是指Hyper Text Transfer Protocol，也就是超文本传输协议。

HTTP默认端口是80。

##### HTTP版本

* HTTP 1.0

该版本是第一个作为正式标准的协议，标准为RFC1945，其之前的版本为HTTP 0.9。

* HTTP 1.1

该版本是当前最主流的版本呢，其最初的标准为RFC2068，之后的修订版为RFC2616。

* HTTP 2.0

该版本是新一代的HTTP协议，其标准为RFC7540。

### HTTP格式

##### 请求格式

HTTP请求信息包含4个部分，请求行，请求头，空行，请求数据。

<table>
	<tr>
    	<td>请求方法 URL 协议版本</td>
        <td>请求行</td>
    </tr>
    <tr>
    	<td>头部字段名 值</td>
        <td rowspan = '3'>请求头</td>
    </tr>
    <tr>
    	<td>头部字段名 值</td>
    </tr>
    <tr>
    	<td>... ...</td>
    </tr>
    <tr>
    	<td colspan = '2'>空行</td>
    </tr>
    <tr>
    	<td colspan = '2'>请求数据</td>
    </tr>
</table>

##### HTTP常见请求头部字段名

|头部字段名|说明|
|:----|:----|
|Accept-Charset|客户端接收的字符集|
|Accept-Encoding|可接收的内容编码|
|Accept-Language|可接受语言|
|Host|主机和端口号|
|User-Agent|操作系统，浏览器等信息|
|Connection|连接状态 HTTP1.1默认为Keep-Alive|

##### 响应格式

响应格式包括4个部分，状态行，响应头，空行，响应数据。

<table>
	<tr>
    	<td>协议版本 状态码 状态码说明</td>
        <td>状态行</td>
    </tr>
    <tr>
    	<td>头部字段名 值</td>
        <td rowspan = '3'>响应头</td>
    </tr>
    <tr>
    	<td>头部字段名 值</td>
    </tr>
    <tr>
    	<td>... ...</td>
    </tr>
    <tr>
    	<td colspan = '2'>空行</td>
    </tr>
    <tr>
    	<td colspan = '2'>响应数据</td>
    </tr>
</table>

##### HTTP常见响应头部字段名

|头部字段名|说明|
|:----|:----|
|Server|服务器名称|
|Content-Type|响应数据格式|
|Content-Encoding|响应数据编码|
|Content-Language|响应数据语言|
|Content-Length|响应数据长度，以字节为单位的十进制个数|
|Keep-Alive|保持连接时间|

##### HTTP常见状态码

|状态码|说明|
|:----|:----|
|200|成功|
|302|重定向至Location指定的URL|
|400|请求语法错误，服务端解析失败|
|403|服务端收到请求但拒绝提供服务|
|404|请求的资源不存在|
|500|服务端发生不可预期的错误|
|503|服务端当前不能处理客户端的请求，过段时间服务端可能恢复正常|

### HTTP通信

HTTP协议是基于TCP/IP协议族进行通信的，其本质还是使用TCP进行数据传输，HTTP协议定义了传输数据的格式。

HTTP是无状态短连接的。

### HTTP版本主要区别

* HTTP 1.0虽然支持长连接，但是其默认是短连接，HTTP 1.1中默认是长连接，长连接是指可以复用TCP，不需要每次传输都建立关闭TCP连接。

* HTTP 1.0传递数据是线性的，例如有两个请求分别为A请求，B请求，HTTP 1.0建立TCP连接后，先发送A请求，收到A请求返回信息后再发送B请求，这样效率并不高。

* HTTP 1.1支持管道化，例如有两个请求分别为A请求，B请求，HTTP 1.0建立TCP连接后，可以将A请求，B请求依次发送出去，然后再等待A请求，B请求的返回信息，管道化需要客户端和服务端都支持，返回信息的顺序需要和发请求的顺序保持一致。

* HTTP 2.0支持多路复用，例如有两个请求分别为A请求，B请求，HTTP 1.0建立TCP连接后，A请求和B请求可以并发请求。

* HTTP 1.1支持断点续传，缓存。

* HTTP 2.0采用二进制分帧，其不再基于文本，而是将所有传输的数据分割为更小的数据和帧并以二进制的格式对其进行编码，提高传输效率。

### HTTP缺点

* 使用明文通信，信息不安全。

* 不验证通信方身份，信息不安全。

* 不验证通信信息的完整性，信息不安全。

### HTTPS

HTTPS等于HTTP加SSL/TLS，其解决了上述HTTP的缺点，但HTTPS的传输效率不如HTTP。

HTTPS默认端口为443。

##### HTTPS流程

HTTPS通信使用了SSL或TLS。

* HTTPS客户端向HTTPS服务端发送请求后，HTTPS服务端会判断HTTPS客户端使用的协议自己是否支持，如支持则返回证书。

* HTTPS客户端验证证书，验证通过并获取证书中HTTPS服务端公钥。

* HTTPS客户端选择确定加密方式，并将自己的密钥用HTTPS服务端公钥加密后发送给HTTPS服务端。

* HTTPS服务端收到用自己公钥加密的信息后，用自己的私钥解密，获取到HTTPS客户端的密钥，然后就可以加密通信了。