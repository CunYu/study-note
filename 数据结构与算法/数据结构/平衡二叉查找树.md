### 概述

平衡二叉查找树是指自平衡二叉查找树，简称平衡二叉树，英文名为Balanced Binary Tree。

二叉查找树在非平衡条件下会降低查询效率，平衡二叉查找树可以保证二叉查找树的查询效率。

### 平衡因子

节点的平衡因子是指节点的左子树高度减去节点的右字数高度。

平衡二叉查找树中节点的平衡因子只能为1，-1，0。

### 逻辑删除

平衡二叉查找树的删除比插入要复杂的多，有时候并不需要真实删除节点，其可以改变节点的状态，表示该节点无效。

### AVL树

AVL树是一种平衡二叉查找树，其是由Adelson-Velskii和Landis发明的，因此称为AVL树。

##### 旋转

AVL树在插入和删除时使用旋转来保证树的平衡。

AVL树旋转的目的是使每个节点的平衡因子绝对值不大于1。

失衡子树，平衡因子绝对值大于1的节点为根的子树。

最小失衡子树，是指失衡子树里的最小子树。

* 插入

插入时只需要处理一个最小失衡子树即可。

* 删除

删除可能需要处理多个最小失衡子树。

* 图示

<img src="./数据结构与算法/数据结构/image/AVL树-旋转.png" alt="AVL树-旋转"/>

### 红黑树

红黑树是一种平衡二叉查找树。

##### 特性

* 红黑树的节点只能是红色或者黑色

* 红黑树的根节点只能为黑色

* 红黑树的每个叶子节点都是黑色的NIL节点

* 红色的节点必须有两个黑色的子节点

* 红黑树的每个节点到其每个叶子节点路径都包含相同数量的黑色节点

红黑树的特性保证了红黑树从根节点到叶子节点的最长距离不会超过最短距离的二倍。

##### 红黑树示例

<img src="./数据结构与算法/数据结构/image/红黑树示例.png" alt="红黑树示例"/>

##### 变色和旋转

红黑树在插入和删除时使用变色和旋转来保证树的平衡。

红黑树变色和旋转的目的是满足红黑树的特性。

红黑树中新增的节点总是红色的。

<img src="./数据结构与算法/数据结构/image/红黑树-旋转.png" alt="红黑树-旋转"/>

### AVL树和红黑树对比

AVL树是追求绝对平衡的，其保证了每个节点的平衡因子绝对值不大于1，红黑树不追求完全平衡，所以AVL树查找效率更高，但是AVL树因为追求绝对平衡，所以其插入和修改时的自平衡操作效率没有红黑树高。